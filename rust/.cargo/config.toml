[target.wasm32-unknown-emscripten]
rustflags = [
    # Threading support (pthreads via Emscripten atomics)
    "-C", "link-args=-pthread",
    "-C", "link-args=-sUSE_PTHREADS=1",
    "-C", "target-feature=+atomics,+bulk-memory,+mutable-globals",
    "-C", "link-args=-sSHARED_MEMORY=1",
    "-C", "link-args=-sPTHREAD_POOL_SIZE=128", # Thread pool size for worker threads (GameActor + ChunkGen + CardCombo + Toast + ResourceLedger + ...)
    "-C", "link-args=-sPTHREAD_POOL_SIZE_STRICT=2", # Throw error instead of deadlock if pool exhausted

    # Godot GDExtension requirements
    "-C", "link-args=-sSIDE_MODULE=2", # Required for Godot GDExtension dynamic loading
    "-C", "link-args=-sEXPORT_ALL=1", # Easier integration (bigger binary); tighten later
    "-C", "link-args=-sERROR_ON_UNDEFINED_SYMBOLS=0", # Godot provides symbols at runtime

    # Build optimizations
    "-Zlink-native-libraries=no",
    "-Cllvm-args=-enable-emscripten-cxx-exceptions=0",
]